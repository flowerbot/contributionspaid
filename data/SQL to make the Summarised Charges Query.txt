SELECT Left([dbo_NUCCHARGECONTROL].[DESCRIPTION],6) AS PLAN, dbo_NUCCHARGECONTROL.DESCRIPTION AS Levy, dbo_RAMAPPLICATIONPROCESS.RAM_ID AS [Application ID], dbo_RAMAPPLICATIONPROCESS.DECISION AS Decision, dbo_RAMAPPLICATIONPROCESS.DESCRIPTION AS [Application Description], Left([dbo_RAMAPPLICATIONPROCESS].[DESCRIPTION],60) AS [Short Description], dbo_nucPropertyAddressView.locality, dbo_RAMAPPLICATIONPROCESS.TEXT1 AS AssessedBy, IIf([DECISION]="Approved","Council",IIf([DECISION]="ApprovMin","Minister",IIf([DECISION]="Court Appr","Court",""))) AS DeterminedBy, dbo_RAMAPPLICATIONPROCESS.DATE9 AS ApprovalDate, Year([dbo_ramApplicationProcess].[DATE9]) AS ApprovalYear, dbo_NUCCHARGE.PROPERTY_NO AS Property_No, IIf([dbo_nucChargeControl].[Description] Like "*Open Space*" Or [dbo_nucChargeControl].[Description] Like "*Structured*" Or [dbo_nucChargeControl].[Description] Like "*Casual*" Or [dbo_nucChargeControl].[Description] Like "*LocalOS*","Open Space",IIf([dbo_nucChargeControl].[Description] Like "*Road*" Or [dbo_nucChargeControl].[Description] Like "*Heavy Haulage*","Roads",IIf([dbo_nucChargeControl].[Description] Like "*Drainage*","Drainage",IIf([dbo_nucChargeControl].[Description] Like "*Community Facilities*" Or [dbo_nucChargeControl].[Description] Like "*Librar*" Or [dbo_nucChargeControl].[Description] Like "*Comm Fac*","Community Facilities","Other")))) AS Purpose, dbo_NUCCHARGE.BALANCE, Sum(dbo_NUCCHARGETRANSACTION.AMOUNT) AS LEVIED, [dbo_NUCCHARGE].[AMOUNT]-[dbo_nucCharge].[BALANCE] AS PAID
FROM ((dbo_NUCCHARGECONTROL RIGHT JOIN (dbo_NUCCHARGE LEFT JOIN dbo_NUCCHARGETRANSACTION ON dbo_NUCCHARGE.CHARGE_CTR = dbo_NUCCHARGETRANSACTION.CHARGE_CTR) ON dbo_NUCCHARGECONTROL.CHARGE_TYPE = dbo_NUCCHARGE.CHARGE_TYPE) LEFT JOIN dbo_RAMAPPLICATIONPROCESS ON dbo_NUCCHARGE.APPLICATION_NO = dbo_RAMAPPLICATIONPROCESS.RAM_PROCESS_CTR) LEFT JOIN dbo_nucPropertyAddressView ON dbo_NUCCHARGE.PROPERTY_NO = dbo_nucPropertyAddressView.property_no
GROUP BY Left([dbo_NUCCHARGECONTROL].[DESCRIPTION],6), dbo_NUCCHARGECONTROL.DESCRIPTION, dbo_RAMAPPLICATIONPROCESS.RAM_ID, dbo_RAMAPPLICATIONPROCESS.DECISION, dbo_RAMAPPLICATIONPROCESS.DESCRIPTION, Left([dbo_RAMAPPLICATIONPROCESS].[DESCRIPTION],60), dbo_nucPropertyAddressView.locality, dbo_RAMAPPLICATIONPROCESS.TEXT1, IIf([DECISION]="Approved","Council",IIf([DECISION]="ApprovMin","Minister",IIf([DECISION]="Court Appr","Court",""))), dbo_RAMAPPLICATIONPROCESS.DATE9, Year([dbo_ramApplicationProcess].[DATE9]), dbo_NUCCHARGE.PROPERTY_NO, IIf([dbo_nucChargeControl].[Description] Like "*Open Space*" Or [dbo_nucChargeControl].[Description] Like "*Structured*" Or [dbo_nucChargeControl].[Description] Like "*Casual*" Or [dbo_nucChargeControl].[Description] Like "*LocalOS*","Open Space",IIf([dbo_nucChargeControl].[Description] Like "*Road*" Or [dbo_nucChargeControl].[Description] Like "*Heavy Haulage*","Roads",IIf([dbo_nucChargeControl].[Description] Like "*Drainage*","Drainage",IIf([dbo_nucChargeControl].[Description] Like "*Community Facilities*" Or [dbo_nucChargeControl].[Description] Like "*Librar*" Or [dbo_nucChargeControl].[Description] Like "*Comm Fac*","Community Facilities","Other")))), dbo_NUCCHARGE.BALANCE, [dbo_NUCCHARGE].[AMOUNT]-[dbo_nucCharge].[BALANCE], dbo_NUCCHARGETRANSACTION.ACCOUNT, dbo_NUCCHARGETRANSACTION.STATUS
HAVING (((Left([dbo_NUCCHARGECONTROL].[DESCRIPTION],6)) Like "S94*") AND ((dbo_RAMAPPLICATIONPROCESS.DECISION) Like "*Appr*") AND ((dbo_NUCCHARGETRANSACTION.ACCOUNT) Like "ZFRI*") AND ((dbo_NUCCHARGETRANSACTION.STATUS)<>"Z"))
ORDER BY dbo_NUCCHARGECONTROL.DESCRIPTION, dbo_NUCCHARGETRANSACTION.ACCOUNT;
